data <- read.table("../data/20170928_Ex009_batch_all_PHO84_validate.csv", sep="\t", as.is=T, head=TRUE, fill=T, na.strings = "NA")
data$Ct <- as.numeric(data$Ct)
View(data)
View(data)
data <- read.table("../data/20170928_Ex009_batch_all_PHO84_validate.csv", sep="\t", as.is=T, head=TRUE, fill=T, na.strings = "NA")
data$Ct <- as.numeric(data$Ct)
pd <- position_dodge(width=0.8)
require(ggplot2)
require(cowplot)
#require(Hmisc)
require(plyr)
require(reshape2)
require(stringr)
pd <- position_dodge(width=0.8)
p <- ggplot( na.omit(data), aes(Strain, Ct, fill=Group, ymax=max(Ct)*1.05) )
p <- p + geom_point(position=pd, shape=23, size=4, alpha=0.75) + facet_wrap( ~Assay)
print( p )
p <- ggplot( na.omit(data), aes(Sample, Ct, fill=Group, ymax=max(Ct)*1.05) )
p <- p + geom_point(position=pd, shape=23, size=4, alpha=0.75) + facet_wrap( ~Assay)
print( p )
pd <- position_dodge(width=0.8)
p <- ggplot( na.omit(data), aes(Sample, Ct, fill=Assay, ymax=max(Ct)*1.05) )
p <- p + geom_point(position=pd, shape=23, size=4, alpha=0.75) + facet_wrap( ~Assay)
print( p )
p <- ggplot( na.omit(data), aes(Sample, Ct, fill=Dilution, ymax=max(Ct)*1.05) )
p <- p + geom_point(position=pd, shape=23, size=4, alpha=0.75) + facet_wrap( ~Assay)
print( p )
p <- ggplot( na.omit(data), aes(Sample, Ct, fill=Replicate, ymax=max(Ct)*1.05) )
p <- p + geom_point(position=pd, shape=23, size=4, alpha=0.75) + facet_wrap( ~Assay)
print( p )
p <- ggplot( na.omit(data), aes(Sample, Ct, fill=as.factor(Replicate), ymax=max(Ct)*1.05) )
p <- p + geom_point(position=pd, shape=23, size=4, alpha=0.75) + facet_wrap( ~Assay)
print( p )
p <- p + geom_point(position=pd, shape=1, size=4, alpha=0.75) + facet_wrap( ~Assay)
p <- ggplot( na.omit(data), aes(Sample, Ct, fill=as.factor(Replicate), ymax=max(Ct)*1.05) )
p <- p + geom_point(position=pd, shape=1, size=4, alpha=0.75) + facet_wrap( ~Assay)
print( p )
print( p + geom_point(position=pd, shape=3, size=1, alpha=0.75) + facet_wrap( ~Assay) )
print( p + geom_point(position=pd, shape=4, size=1, alpha=0.75) + facet_wrap( ~Assay) )
p <- ggplot( na.omit(data), aes(Sample, Ct, fill=as.factor(Replicate), ymax=max(Ct)*1.05) )
print( p + geom_point(position=pd, shape=4, size=1, alpha=0.75) + facet_wrap( ~Assay) )
print( p + geom_point(position=pd, alpha=0.75) + facet_wrap( ~Assay) )
pd <- position_dodge(width=0.9)
p <- ggplot( na.omit(data), aes(Sample, Ct, fill=as.factor(Replicate), ymax=max(Ct)*1.05) )
print( p + geom_point(position=pd, alpha=0.75) + facet_wrap( ~Assay) )
p <- ggplot( na.omit(data), aes(Sample, Ct, color=as.factor(Replicate), ymax=max(Ct)*1.05) )
print( p + geom_point(position=pd, alpha=0.75) + facet_wrap( ~Assay) )
print( p + geom_point() + facet_wrap( ~Assay) )
print( p + geom_point(size = 3) + facet_wrap( ~Assay) )
p <- ggplot( na.omit(data), aes(Sample, Ct, ymax=max(Ct)*1.05) )
print( p + geom_point(size = 3) + facet_wrap( ~Assay) )
print( p + geom_point(shape = 1, size = 3) + facet_wrap( ~Assay) )
data.abi <- subset(data, Master == "AmpliGold")
p <- ggplot( na.omit(data.abi), aes(Sample, Ct, ymax=max(Ct)*1.05) )
print( p + geom_point(shape = 1, size = 3) + facet_wrap( ~Assay) )
pd <- position_dodge(width=0.5)
p <- ggplot( na.omit(data.abi), aes(Sample, Ct, color = as.factor(Dilution), ymax=max(Ct)*1.05) )
print( p + geom_point(position = pd, shape = 1, size = 3) + facet_wrap( ~Assay) )
pd <- position_jitter(width=0.5)
p <- ggplot( na.omit(data.abi), aes(Sample, Ct, color = as.factor(Dilution), ymax=max(Ct)*1.05) )
print( p + geom_point(position = pd, shape = 1, size = 3) + facet_wrap( ~Assay) )
pd <- position_jitter(width=0.1)
p <- ggplot( na.omit(data.abi), aes(Sample, Ct, color = as.factor(Dilution), ymax=max(Ct)*1.05) )
print( p + geom_point(position = pd, shape = 1, size = 3) + facet_wrap( ~Assay) )
data$Sample <- factor(data$Sample, levels = c("NTC","S37","S7","S15","S19","S1","S3","S5","S21"))
data.abi <- subset(data, Master == "AmpliGold")
pd <- position_jitter(width=0.1)
p <- ggplot( na.omit(data.abi), aes(Sample, Ct, color = as.factor(Dilution), ymax=max(Ct)*1.05) )
print( p + geom_point(position = pd, shape = 1, size = 3) + facet_wrap( ~Assay) )
data <- read.table("../data/20170928_Ex009_batch_all_PHO84_validate.csv", sep="\t", as.is=T, head=TRUE, fill=T, na.strings = "NA")
data$Ct <- as.numeric(data$Ct)
data <- read.table("../data/20170928_Ex009_batch_all_PHO84_validate.csv", sep="\t", as.is=T, head=TRUE, fill=T, na.strings = "NA")
data$Ct <- as.numeric(data$Ct)
View(data)
data <- read.table("../data/20170928_Ex009_batch_all_PHO84_validate.csv", sep=",", as.is=T, head=TRUE, fill=T, na.strings = "NA")
data$Ct <- as.numeric(data$Ct)
data$Sample <- factor(data$Sample, levels = c("NTC","S37","S7","S15","S19","S1","S3","S5","S21"))
data.abi <- subset(data, Master == "AmpliGold")
pd <- position_jitter(width=0.1)
p <- ggplot( na.omit(data.abi), aes(Sample, Ct, color = as.factor(Dilution), ymax=max(Ct)*1.05) )
print( p + geom_point(position = pd, shape = 1, size = 3) + facet_wrap( ~Assay) )
print( p + geom_point(position = pd, shape = 4, size = 3) + facet_wrap( ~Assay) )
print( p + geom_point(position = pd, shape = 20, size = 3) + facet_wrap( ~Assay) )
print( p + geom_point(position = pd, shape = 24, size = 3) + facet_wrap( ~Assay) )
print( p + geom_point(position = pd, shape = 14, size = 3) + facet_wrap( ~Assay) )
print( p + geom_point(position = pd, shape = 18, size = 3) + facet_wrap( ~Assay) )
print( p + geom_point(position = pd, shape = 18, size = 4) + facet_wrap( ~Assay) )
print( p + geom_point(position = pd, shape = 24, size = 4) + facet_wrap( ~Assay) )
print( p + geom_point(position = pd, shape = 24, size = 2) + facet_wrap( ~Assay) )
eff.abi <- ddply( subset(data.abi,Sample == "S37"), .(Assay), linmod)
slope <- as.numeric(coef(lm)[2])
linmod <- function(df) {
if( sum(!is.na(df$Ct)) == 0 ) { # if no non-NA data
return( c("intercept"=NA, "slope"=NA, "p.value"=NA, "r.squared"=NA) )
}
lm <- lm( log2(Dilution) ~ Ct, data=df, na.action = "na.omit")
intercept <- as.numeric(coef(lm)[1])
slope <- as.numeric(coef(lm)[2])
efficiency <- 2^(slope)
sum <- summary(lm)
p <- coef(sum)[2,4]
R2 <- sum$r.squared
return( c("efficiency"=efficiency, "intercept"=intercept, "slope"=slope, "p.value"=p, "r.squared"=R2) )
}
eff.abi <- ddply( subset(data.abi,Sample == "S37"), .(Assay), linmod)
eff.one <- ddply( subset(data,Sample == "S37" & Master == "OneTaq"), .(Assay), linmod)
print(eff.abi, digits=3)
p <- ggplot( subset(data.abi, Sample == "S37"), aes(Ct, log2(Dilution)) )
p <- p + geom_abline(data=eff.abi, aes(intercept=intercept, slope=slope))
p + geom_point() + facet_wrap( ~ Assay )
# Calc primer amplification efficiency
linmod <- function(df) {
if( sum(!is.na(df$Ct)) == 0 ) { # if no non-NA data
return( c("intercept"=NA, "slope"=NA, "p.value"=NA, "r.squared"=NA) )
}
lm <- lm( log2(Dilution) ~ Ct, data=df, na.action = "na.omit")
intercept <- as.numeric(coef(lm)[1])
slope <- as.numeric(coef(lm)[2])
efficiency <- 2^(slope)
sum <- summary(lm)
p <- coef(sum)[2,4]
R2 <- sum$r.squared
return( c("efficiency"=efficiency, "intercept"=intercept, "slope"=slope, "p.value"=p, "r.squared"=R2) )
}
eff.abi <- ddply( subset(data.abi,Sample == "S37"), .(Assay), linmod)
eff.one <- ddply( subset(data,Sample == "S37" & Master == "OneTaq"), .(Assay), linmod)
# Standard curve, ABI AmpliGold master mix
print(eff.abi, digits=3)
p <- ggplot( subset(data.abi, Sample == "S37"), aes(Ct, log2(Dilution)) )
p <- p + geom_abline(data=eff.abi, aes(intercept=intercept, slope=slope))
p + geom_point() + facet_wrap( ~ Assay )
# Standard curve, Serge's OneTaq recipe
print(eff.one, digits=3)
p <- ggplot( subset(data, Sample == "S37" & Master == "OneTaq"), aes(Ct, log2(Dilution)) )
p <- p + geom_abline(data=eff.one, aes(intercept=intercept, slope=slope))
p + geom_point() + facet_wrap( ~ Assay )
data <- read.table("../data/20170928_Ex009_batch_all_PHO84_validate.csv", sep=",", as.is=T, head=TRUE, fill=T, na.strings = "NA")
data$Ct <- as.numeric(data$Ct)
data$Sample <- factor(data$Sample, levels = c("NTC","S37","S7","S15","S19","S1","S3","S5","S21"))
data.abi <- subset(data, Master == "AmpliGold")
data <- read.table("../data/20170928_Ex009_batch_all_PHO84_validate.csv", sep=",", as.is=T, head=TRUE, fill=T, na.strings = "NA")
data$Ct <- as.numeric(data$Ct)
data$Sample <- factor(data$Sample, levels = c("NTC","S37.one","S37","S7","S15","S19","S1","S3","S5","S21"))
data.abi <- subset(data, Master == "AmpliGold")
pd <- position_jitter(width=0.1)
p <- ggplot( na.omit(data), aes(Sample, Ct, color = as.factor(Dilution), ymax=max(Ct)*1.05) )
print( p + geom_point(position = pd, shape = 24, size = 2) + facet_wrap( ~Assay) )
require(ggplot2)
require(cowplot)
#require(Hmisc)
require(plyr)
require(reshape2)
require(stringr)
data <- read.table("../data/20170928_Ex009_batch_all_PHO84_validate.csv", sep=",", as.is=T, head=TRUE, fill=T, na.strings = "NA")
data$Ct <- as.numeric(data$Ct)
data$Sample <- factor(data$Sample, levels = c("NTC","S37a","S37","S7","S15","S19","S1","S3","S5","S21"))
data.abi <- subset(data, Master == "AmpliGold")
pd <- position_jitter(width=0.1)
p <- ggplot( na.omit(data), aes(Sample, Ct, color = as.factor(Dilution), ymax=max(Ct)*1.05) )
print( p + geom_point(position = pd, shape = 24, size = 2) + facet_wrap( ~Assay) )
data <- read.table("../data/20170928_Ex009_batch_all_PHO84_validate.csv", sep=",", as.is=T, head=TRUE, fill=T, na.strings = "NA")
data$Ct <- as.numeric(data$Ct)
data$Sample <- factor(data$Sample, levels = c("NTC","S37","S7","S15","S19","S1","S3","S5","S21"))
data.abi <- subset(data, Master == "AmpliGold")
pd <- position_jitter(width=0.1)
p <- ggplot( na.omit(data.abi), aes(Sample, Ct, color = as.factor(Dilution), ymax=max(Ct)*1.05) )
print( p + geom_point(position = pd, shape = 24, size = 2) + facet_wrap( ~Assay) )
res <- ddply( data.abi, .(Sample, Assay), summarize,
mean = mean(Ct-log2(Dilution), na.rm=T),
sem = sd(Ct-log2(Dilution), na.rm=T) / sqrt(length(Ct)),
.drop=TRUE )
res
fold.d <- dcast(res, Sample ~ Assay, value.var = "mean")
fold.d
fold.d$dCt <- fold.d$ACT1 - fold.d$PHO84
fold.d
ddCt <- with(fold.d, c( "80-.hiPi" = dCt[Sample == "S37"] - dCt[Sample == "S1"] ))
ddCt
sprintf("Pho84 was induced %.0f fold in pho80∆ relative to pho80∆ pho4∆", 2^ddCt)
ddCt
names(ddCt)
sprintf("Pho84 was induced %.0f fold in pho80∆ relative to pho80∆ pho4∆", 2^ddCt["80-.hiPi"])
ddCt <- with(fold.d, c(
"80-.hiPi" = dCt[Sample == "S37"] - dCt[Sample == "S1"],
"80+.4-.noPi.60'" = dCt[Sample == "S21"] - dCt[Sample == "S5"]
))
ddCt
dCt
fold.d
ddCt <- with(fold.d, c(
"80-.4+.hiPi" = dCt[Sample == "S37"] - dCt[Sample == "S1"],
"80+.4-.noPi.60'" = dCt[Sample == "S21"] - dCt[Sample == "S5"],
"80+.4+.noPi.20'" = dCt[Sample == "S7"] - dCt[Sample == "S3"],
"80+.4+.noPi.45'" = dCt[Sample == "S15"] - dCt[Sample == "S3"],
"80+.4+.noPi.60'" = dCt[Sample == "S19"] - dCt[Sample == "S3"]
))
ddCt
sprintf("Pho84 was induced %.0f fold in pho80∆ relative to pho80∆ pho4∆", 2^ddCt["80-.hiPi"])
sprintf("Pho84 was induced %.0f fold in pho80∆ relative to pho80∆ pho4∆", 2^ddCt["80-.4+.hiPi"])
names(ddCt)
?grep
grep("80+.4+", names(ddCt))
grep("80\+\.4\+", names(ddCt))
grep("80+.4+", names(ddCt), fixed = TRUE)
grep("80+.4+", names(ddCt), fixed = TRUE, value = TRUE)
sprintf("and %.0f fold in wildtype under no Pi after 20', 45' and 60'", 2^ddCt[grep("80+.4+", fixed = TRUE, value = TRUE)])
sprintf("and %.0f fold in wildtype under no Pi after 20', 45' and 60'", 2^ddCt[grep("80+.4+", names(ddCt), fixed = TRUE, value = TRUE)])
sprintf
?sprintf
sprintf("min 10-char string '%10s'",
c("a", "ABC", "and an even longer one"))
printf(paste0("e with %2d digits = %.", n, "g"), n, exp(1))
sprintf(paste0("e with %2d digits = %.", n, "g"), n, exp(1))
n <- 1:18
sprintf(paste0("e with %2d digits = %.", n, "g"), n, exp(1))
sprintf("and %.0f fold in wildtype after %2d minutes of Pi starvation", t, 2^ddCt[paste0("80+.4+.",t,"'",collapse = "")])
paste("aa",c(1,5))
paste0("aa",c(1,5))
sprintf("and %.0f fold in wildtype after %2d minutes of Pi starvation", t, 2^ddCt[paste0("80+.4+.",t,"'")])
t <- c(20,45,60)
sprintf("and %.0f fold in wildtype after %2d minutes of Pi starvation", t, 2^ddCt[paste0("80+.4+.",t,"'")])
sprintf("and %.0f fold in wildtype after %d minutes of Pi starvation", t, 2^ddCt[paste0("80+.4+.",t,"'")])
sprintf("%d",12)
sprintf("%2d",12)
sprintf("%2d",c(20,45,60))
sprintf("%2d",t)
t <- c(20,45,60)
sprintf("and %.0f fold in wildtype after %2d minutes of Pi starvation", 2^ddCt[paste0("80+.4+.",t,"'")], t)
paste0("80+.4+.",t,"'")
ddCt[paste0("80+.4+.",t,"'")]
names(ddCt)
sprintf("and %.0f fold in wildtype after %2d minutes of Pi starvation", 2^ddCt[paste0("80+.4+.noPi.",t,"'")], t)
sprintf("Pho84 was induced %.0f fold in pho4∆ after 60' of Pi starvation", 2^ddCt["80+.4-.noPi.60'"])
p <- ggplot( subset(data.abi, Sample == "S37"), aes(Ct, log2(Dilution)) )
p <- p + geom_abline(data=eff.abi, aes(intercept=intercept, slope=slope))
p + geom_point() + facet_wrap( ~ Assay )
# Calc primer amplification efficiency
linmod <- function(df) {
if( sum(!is.na(df$Ct)) == 0 ) { # if no non-NA data
return( c("intercept"=NA, "slope"=NA, "p.value"=NA, "r.squared"=NA) )
}
lm <- lm( log2(Dilution) ~ Ct, data=df, na.action = "na.omit")
intercept <- as.numeric(coef(lm)[1])
slope <- as.numeric(coef(lm)[2])
efficiency <- 2^(slope)
sum <- summary(lm)
p <- coef(sum)[2,4]
R2 <- sum$r.squared
return( c("efficiency"=efficiency, "intercept"=intercept, "slope"=slope, "p.value"=p, "r.squared"=R2) )
}
eff.abi <- ddply( subset(data.abi,Sample == "S37"), .(Assay), linmod)
eff.one <- ddply( subset(data,Sample == "S37" & Master == "OneTaq"), .(Assay), linmod)
# Standard curve, ABI AmpliGold master mix
print(eff.abi, digits=3)
p <- ggplot( subset(data.abi, Sample == "S37"), aes(Ct, log2(Dilution)) )
p <- p + geom_abline(data=eff.abi, aes(intercept=intercept, slope=slope))
p + geom_point() + facet_wrap( ~ Assay )
# Standard curve, Serge's OneTaq recipe
print(eff.one, digits=3)
p <- ggplot( subset(data, Sample == "S37" & Master == "OneTaq"), aes(Ct, log2(Dilution)) )
p <- p + geom_abline(data=eff.one, aes(intercept=intercept, slope=slope))
p + geom_point() + facet_wrap( ~ Assay )
View(data)
data <- read.table("../data/20170928_Ex009_batch_all_PHO84_validate.csv", sep=",", as.is=T, head=TRUE, fill=T, na.strings = "NA")
data$Ct <- as.numeric(data$Ct)
data$Sample <- factor(data$Sample, levels = c("NTC","S37","S7","S15","S19","S1","S3","S5","S21"))
data.abi <- subset(data, Master == "AmpliGold")
View(data)
